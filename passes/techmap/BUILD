genrule(
        name = "techmap_inc",
        srcs = ["//techlibs/common:techmap_v"],
        outs = ["techmap.inc"],
        cmd = """
                echo "// autogenerated from $<" > "$@"
                echo "static char stdcells_code[] = {" >> "$@"
                od -v -td1 -An $< | sed -e 's/[0-9][0-9]*/&,/g' >> "$@"
                echo "0};" >> "$@"
        """,
        visibility = ["//passes:__subpackages__"],
)

cc_library(
        name = "techmap",
        srcs = glob(["*.cc"], exclude=["filterlib.cc"]) + [":techmap_inc"],
        hdrs = glob(["*.h"]),
        visibility = [
                "//kernel:__subpackages__",
                "//passes:__subpackages__",
                "//techlibs:__subpackages__",
        ],
        deps = [
                "//kernel:kernel",
                "//libs:subcircuit",
                "//frontends:blif",
        ],
)
